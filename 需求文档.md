# 金牛区固定投资项目管理平台 - 需求文档

## 项目概述

**项目名称**: 金牛区固定投资项目管理平台  
**技术栈**: Vue 3 + TypeScript + Ant Design Vue  
**项目地址**: https://github.com/stargao/jinniu-project  
**最后更新**: 2025-02-06

---

## 1. 系统概述

本项目是一个基于 Web 的固定投资项目管理信息系统，用于管理金牛区的各类投资项目。系统采用 B/S 架构，前端使用 Vue 3 和 Ant Design Vue 框架，通过 RESTful API 与后端进行数据交互。

---

## 2. 系统架构

### 2.1 技术架构
- **前端框架**: Vue 3 (Composition API)
- **UI 组件库**: Ant Design Vue 4.x
- **状态管理**: Pinia
- **路由管理**: Vue Router 5
- **构建工具**: Vite
- **语言**: TypeScript

### 2.2 系统布局
- **顶部 Header**: 系统名称、用户信息、通知
- **左侧 Sidebar**: 三级菜单导航（可折叠）
- **主内容区**: 标签页导航 + 功能页面

---

## 3. 功能模块

### 3.1 全部项目
#### 3.1.1 项目申报
- 功能：项目信息的录入、编辑、审核
- 页面：`/all-projects/project-declaration`
- 特性：
  - 通用查询组件（QueryBuilder）
  - 数据表格展示（固定列）
  - 项目录入弹窗（三步向导）
  - 支持导入、储备项目

#### 3.1.2 进度报送
- 功能：项目进度的定期报送和审核
- 页面：`/all-projects/progress-report`
- 特性：
  - 进度填报弹窗（三步向导）
  - 进度审核弹窗
  - 进度预警、查询、统计

#### 3.1.3 项目浏览
- 功能：浏览和查看项目信息
- 页面：`/all-projects/project-browse`
- 特性：
  - 项目列表展示
  - 详情抽屉查看
  - 更新记录查看

### 3.2 策划储备项目
- 功能：预备项目的管理和转化
- 页面：`/planning-reserve/preparation`
- 特性：入库、审核、退回、转化

### 3.3 地理信息
- 功能：项目地理位置管理
- 页面：`/geographic-info/map`
- 特性：地图标记、项目位置展示

### 3.4 短信管理
- 功能：短信提醒配置
- 页面：`/sms-management/settings`
- 特性：提醒开关、模板设置、接收人配置

---

## 4. 核心组件

### 4.1 QueryBuilder（通用查询组件）
**路径**: `src/components/common/QueryBuilder.vue`

**功能**:
- 标签化的查询条件管理
- 动态操作符和输入组件
- 支持 AND/OR 逻辑组合
- 支持多种字段类型（string、number、date、select）

**使用示例**:
```vue
<QueryBuilder
  :fields="queryFields"
  @search="handleSearch"
  @reset="handleReset"
/>
```

### 4.2 MainLayout（主布局组件）
**路径**: `src/layouts/MainLayout.vue`

**功能**:
- Header + Sidebar + Tabs 布局
- 标签页导航
- 侧边栏折叠

### 4.3 SidebarMenu（侧边栏菜单）
**路径**: `src/components/common/SidebarMenu.vue`

**功能**:
- 三级菜单结构
- 菜单项图标
- 自动展开/收起

---

## 5. 数据库设计（建议）

### 5.1 核心表结构
- **T2_JBXX**: 项目基本信息表
- **T2_JBXX_ZRTX**: 项目责任体系表
- **T2_ZJLY**: 资金来源表
- **T2_NDXX**: 项目年度信息表
- **T2_JDXX**: 项目进度信息表
- **T2_JDXX_FJ**: 进度附件表

### 5.2 表关系
- T2_JBXX_ZRTX (1:1) → T2_JBXX
- T2_ZJLY (1:1) → T2_JBXX
- T2_NDXX (1:N) → T2_JBXX
- T2_JDXX (1:N) → T2_JBXX
- T2_JDXX_FJ (1:N) → T2_JDXX

---

## 6. API 接口设计

### 6.1 项目管理接口
- `POST /api/projects` - 创建项目草稿
- `PUT /api/projects/:id` - 更新项目信息
- `POST /api/projects/:id/submit` - 提交审核
- `POST /api/projects/:id/progress-reports` - 提交进度报告

### 6.2 查询接口
- `GET /api/projects` - 查询项目列表
- `GET /api/projects/:id` - 获取项目详情

---

## 7. 变更历史

### 2025-02-06
#### 新增功能
- ✅ 创建通用查询组件 QueryBuilder
  - 支持标签化查询条件管理
  - 动态操作符和输入组件
  - 支持 AND/OR 逻辑组合
  - 支持多种字段类型（string、number、date、select）
  
- ✅ 更新项目申报页面
  - 替换传统表单搜索为 QueryBuilder 组件
  - 配置查询字段（项目编号、项目名称、项目类别等）
  - 添加查询和重置事件处理

#### 技术改进
- ✅ 修复表格固定列样式问题
- ✅ 统一表格操作列宽度为 280px
- ✅ 添加序号和项目编号列固定

---

## 8. 待办事项（TODO）

### 高优先级
- [ ] 完善项目录入弹窗的字段验证
- [ ] 实现项目列表的筛选和排序功能
- [ ] 添加项目详情查看页面

### 中优先级
- [ ] 实现进度报送的图片上传功能
- [ ] 添加项目统计图表
- [ ] 实现问题协调模块

### 低优先级
- [ ] 集成地图组件到地理信息页面
- [ ] 实现短信发送功能
- [ ] 添加系统设置页面

---

## 9. 已知问题

### 当前版本问题
- [ ] 项目申报页面的表格在横向滚动时，固定列样式需要优化
- [ ] QueryBuilder 组件的日期范围选择器需要完善

### 解决方案
- 使用 CSS 确保固定列在滚动时正确显示
- 完善日期范围选择器的值处理逻辑

---

## 10. 开发规范

### 10.1 代码规范
- 使用 TypeScript 进行类型定义
- 组件使用 Composition API
- 样式使用 scoped CSS
- 遵循 ESLint 规则

### 10.2 命名规范
- 组件文件：PascalCase（如 ProjectFormModal.vue）
- 工具函数：camelCase（如 formatDate）
- 常量：UPPER_SNAKE_CASE（如 API_BASE_URL）

### 10.3 Git 提交规范
- feat: 新功能
- fix: 修复 bug
- docs: 文档更新
- style: 代码格式调整
- refactor: 重构
- test: 测试相关
- chore: 构建/工具链相关

---

## 附录

### A. 项目目录结构
```
jinniu-project/
├── src/
│   ├── api/              # API 接口
│   ├── assets/           # 静态资源
│   ├── components/       # 通用组件
│   │   └── common/       # 公共组件
│   │       ├── QueryBuilder.vue
│   │       └── SidebarMenu.vue
│   ├── layouts/          # 布局组件
│   │   └── MainLayout.vue
│   ├── router/           # 路由配置
│   ├── stores/           # 状态管理
│   ├── types/            # TypeScript 类型
│   └── views/            # 页面组件
├── public/               # 公共资源
├── 需求文档.md           # 本文档
└── package.json
```

### B. 相关文档
- [金牛区固定投资项目管理平台-AI可读需求规格说明书 (V2).md](./金牛区固定投资项目管理平台-AI可读需求规格说明书%20(V2).md)
- [通用查询组件重构设计文档.md](./通用查询组件重构设计文档.md)

---

**文档维护**: 本文档应随着项目开发持续更新，记录所有功能变更和技术决策。
